# Samba Configuration for Banana Pi NAS
# High-performance configuration optimized for home networks

[global]
   workgroup = WORKGROUP
   server string = %h server (Samba)

   # Network discovery settings
   netbios name = BANANAPI
   wins support = yes
   local master = yes
   preferred master = yes
   os level = 65

   # Security and authentication
   security = user
   map to guest = Bad User
   guest account = nobody

   # Protocol settings - Force SMB3 for best performance
   server min protocol = SMB3
   client min protocol = SMB2
   client max protocol = SMB3_11

   # High-performance optimizations
   socket options = TCP_NODELAY SO_RCVBUF=524288 SO_SNDBUF=524288
   use sendfile = yes
   min receivefile size = 16384
   aio read size = 1
   aio write size = 1
   write cache size = 524288
   max xmit = 65536
   dead time = 15
   getwd cache = yes

   # Disable oplocks for better compatibility
   oplocks = no
   level2 oplocks = no
   kernel oplocks = no

   # Logging (reduced for performance)
   log file = /var/log/samba/log.%m
   max log size = 50
   log level = 0

   # Printer support
   load printers = yes
   printing = cups
   printcap name = cups

   # File permissions
   create mask = 0664
   directory mask = 0775
   force create mode = 0664
   force directory mode = 0775

   # Browsing
   browseable = yes

   # Enable extended attributes for Mac compatibility
   ea support = yes
   vfs objects = fruit streams_xattr
   fruit:metadata = stream
   fruit:model = MacSamba
   fruit:veto_appledouble = no
   fruit:posix_rename = yes
   fruit:zero_file_id = yes
   fruit:wipe_intentionally_left_blank_rfork = yes
   fruit:delete_empty_adfiles = yes

[homes]
   comment = Home Directories
   browseable = no
   read only = no
   create mask = 0700
   directory mask = 0700
   valid users = %S

[printers]
   comment = All Printers
   browseable = no
   path = /var/tmp
   printable = yes
   guest ok = no
   read only = yes
   create mask = 0700

[print$]
   comment = Printer Drivers
   path = /var/lib/samba/printers
   browseable = yes
   read only = no
   guest ok = no

[HDD750GB]
   comment = HDD 750GB Storage
   path = /media/HDD750GB
   browseable = yes
   read only = no
   guest ok = yes
   create mask = 0664
   directory mask = 0775
   force user = engineer
   force group = engineer
   veto files = /._*/.DS_Store/.Trashes/
   delete veto files = yes
   # Performance optimizations
   strict locking = no
   strict allocate = yes
   allocation roundup size = 4096

[Dzianis-2]
   comment = Dzianis-2 Storage
   path = /media/Dzianis-2
   browseable = yes
   read only = no
   guest ok = yes
   create mask = 0664
   directory mask = 0775
   force user = engineer
   force group = engineer
   veto files = /._*/.DS_Store/.Trashes/
   delete veto files = yes
   # Performance optimizations
   strict locking = no
   strict allocate = yes
   allocation roundup size = 4096